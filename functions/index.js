const functions=require('firebase-functions'); const admin=require('firebase-admin'); if(!admin.apps.length){ admin.initializeApp(); } exports.setUserRole=functions.https.onCall(async(data,context)=>{ if(!context.auth) throw new functions.https.HttpsError('unauthenticated','Must be authenticated'); const {email,role}=data||{}; if(!email||!role) throw new functions.https.HttpsError('invalid-argument','email and role required'); const user=await admin.auth().getUserByEmail(email); await admin.auth().setCustomUserClaims(user.uid,{role}); return {ok:true,message:`Set role ${role} on ${email}`}; });
